# deploy-to-git [![npm version](https://badge.fury.io/js/deploy-to-git.svg)](https://badge.fury.io/js/deploy-to-git)
Automatically or manually deploy build artifacts to a Git repository. The tool works awesome with [semantic-release](https://github.com/semantic-release/semantic-release) or manual releasing and any CI service.

```
npm install --save-dev deploy-to-git
```

## Configuring

Configuration for the tool needs to be placed at ``config.deployToGit`` object inside  package.json. All fields are required.

- ``repository`` - a repository
- ``branch`` - a branch of the repository where you want to push the artifacts
- ``folder`` - a folder where artifacts are generated by the build and where the repository is cloned
- ``script`` - a script which runs the build
- ``commit`` - commit text
- ``user`` - commitee information for Git - an object with keys ``name`` and ``email``

Substrings started with ``$`` are replaced by corresponding environment variables.

## Getting started

Let's say you want to deploy artifacts to branch called ``artifacts``. Let's say your build tool (eg. webpack) compiles the artifacts to ``build`` folder via NPM script ``build-my-app``. You'll need:

1. Create ``artifacts`` branch manually and remove all files from it (if you create the branch copying main branch contents). Push it to remote repository.
2. Add README or whatever you want to have at this branch.
3. Add ``build`` folder to ``.gitignore`` of your main branch.
4. Configure ``deploy-to-git``

```js
"scipts": {
  "deploy": "deploy-to-git",
  "build-my-app": "a-build-script"
}
"config": {
  "deployToGit": {
      "repository": "git@github.com:owner/your-repo.git",
      "branch": "artifacts",
      "folder": "build",
      "script": "npm run build-my-app",
      "commit": "Automatic commit text",
      "user": {
          "email": "you@example.com",
          "name": "Your name"
      }
  }
}
```

That's it. When you run ``npm run deploy`` the tool does the following:

1. Clone the repository to ``build`` folder.
2. Run script ``npm run build-my-app`` which creates/replaces files at ``build`` folder.
3. Commit and push changes.

Tip: remove ``build`` folder before ``deploy-to-git`` run.


## Travis CI

To run it on Travis CI just use the following format of ``repository`` field: ``https://$GH_TOKEN@github.com/owner/your-repo.git``.

## semantic-release

There is nothing specific. Just add ``deploy-to-github`` to ``semantic-release`` script.

```
"semantic-release": "semantic-release pre && deploy-to-git && npm publish && semantic-release post",
```

Tip: You can use a new version in commit message:
```
"commit": "Publising $npm_package_version",
```

## Real example

Real example lives [there](https://github.com/finom/github-embed). It compiled the application via webpack to ``bundle`` folder and pushes to [gh-pages branch](https://github.com/finom/github-embed/tree/gh-pages).
